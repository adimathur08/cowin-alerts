<!DOCTYPE html>
<html>
<head>
	<title>Vaccine Slot Tracker	</title>
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous"> -->

<style type="text/css">

	.tgl {
	  display: none;
	}
	.tgl, .tgl:after, .tgl:before, .tgl *, .tgl *:after, .tgl *:before, .tgl + .tgl-btn {
	  box-sizing: border-box;
	}
	.tgl::-moz-selection, .tgl:after::-moz-selection, .tgl:before::-moz-selection, .tgl *::-moz-selection, .tgl *:after::-moz-selection, .tgl *:before::-moz-selection, .tgl + .tgl-btn::-moz-selection {
	  background: none;
	}
	.tgl::selection, .tgl:after::selection, .tgl:before::selection, .tgl *::selection, .tgl *:after::selection, .tgl *:before::selection, .tgl + .tgl-btn::selection {
	  background: none;
	}
	.tgl + .tgl-btn {
	  outline: 0;
	  display: block;
	  width: 5em;
	  height: 2em;
	  position: relative;
	  cursor: pointer;
	  -webkit-user-select: none;
	     -moz-user-select: none;
	      -ms-user-select: none;
	          user-select: none;
	}
	.tgl + .tgl-btn:after, .tgl + .tgl-btn:before {
	  position: relative;
	  display: block;
	  content: "";
	  width: 50%;
	  height: 100%;
	}
	.tgl + .tgl-btn:after {
	  left: 0;
	}
	.tgl + .tgl-btn:before {
	  display: none;
	}
	.tgl:checked + .tgl-btn:after {
	  left: 50%;
	}

	.tgl-flip + .tgl-btn {
	  padding: 2px;
	  transition: all 0.2s ease;
	  font-family: sans-serif;
	  perspective: 100px;
	}
	.tgl-flip + .tgl-btn:after, .tgl-flip + .tgl-btn:before {
	  display: inline-block;
	  transition: all 0.4s ease;
	  width: 100%;
	  text-align: center;
	  position: absolute;
	  line-height: 2em;
	  font-weight: bold;
	  color: #000/*#fff*/;
	  position: absolute;
	  top: 0;
	  left: 0;
	  -webkit-backface-visibility: hidden;
	          backface-visibility: hidden;
	  border-radius: 4px;
	}
	.tgl-flip + .tgl-btn:after {
	  content: attr(data-tg-on);
	  background: white /*#02C66F*/;
	  transform: rotateY(-180deg);
	}
	.tgl-flip + .tgl-btn:before {
	  background: white /*#FF3A19*/;
	  border : 0.1px solid;
	  content: attr(data-tg-off);
	}
	.tgl-flip + .tgl-btn:active:before {
	  transform: rotateY(-20deg);
	}
	.tgl-flip:checked + .tgl-btn:before {
	  transform: rotateY(180deg);
	}
	.tgl-flip:checked + .tgl-btn:after {
	  transform: rotateY(0);
	  left: 0;
	  border: 0.1px solid;
	  background: white /*#7FC6A6*/;
	}
	.tgl-flip:checked + .tgl-btn:active:after {
	  transform: rotateY(20deg);
	}

	.ck-button {
	    margin:4px;
	    background-color:#EFEFEF;
	    border-radius:10px;
	    border:1px solid #D0D0D0;
	    overflow:auto;
	    float:left;
	/*        padding-left: 5px;
	    padding-right: 5px;*/
	}

	.ck-button:hover {
	    margin:4px;
	    border-radius:10px;
	    border:1px solid #002060;
	    overflow:auto;
	    float:left;
	    /*color:#002060;
	    background-color:#EFEFEF;*/
	    background-color:#002060;
	    color:#fff;
	/*        padding-left: 5px;
	    padding-right: 5px;*/
	}

	.ck-button label {
	    float:left;
	    width: 100px;
	   /* width:fit-content;
	    padding-left: 5px;
	    padding-right: 5px;*/
	}

	.ck-button label span {
		font-size: 15px;
	    text-align:center;
	    padding:3px 0px;
	    display:block;
	}

	.ck-button label input {
	    position:absolute;
	    top:-20px;
	}

	.ck-button input:checked + span {
	    background-color:#002060;
	    color:#fff;
	}



	/*START BUTTON*/
	.startBtn {
	  /*background-color: #4CAF50; Green */
	  background-color: white; 
	  /*border: 1px solid;*/
	  border: 1px solid ;
	  border-radius:10px;
	  /*color: white;*/
	  color: black; 
	  padding: 8px 16px;
	  text-align: center;
	  text-decoration: none;
	  display: inline-block;
	  font-size: 16px;
	  margin: 4px 2px;
	  transition-duration: 0.4s;
	  cursor: pointer;
	}
	.startBtn:hover {
	  background-color: #4CAF50;
	  color: white;
	}

	/*Past Button*/
		#pastButton {
	  /*background-color: #4CAF50; Green */
	  background-color: white; 
	  border: 1px solid ;
	  border-radius:10px;
	  color: black; 
	  padding: 6px 12px;
	  text-align: center;
	  text-decoration: none;
	  display: inline-block;
	  font-size: 14px;
	  margin: 4px 2px;
	  transition-duration: 0.4s;
	  cursor: pointer;
	}
	#pastButton:hover {
	  background-color: #002060;
	  color: white;
	}
</style>


</head>
<body>
	<audio id="audioAlert" src="alert.wav" preload="auto" autoplay></audio>
	<button id="playAudio" onclick="playAudio()" hidden>Play</button>
	<div style="text-align: center; margin:auto; justify-content: center;">
		<span id="errorDisplay" style="color:red;"></span>		
	</div>
	<!-- <button id="check" onclick="checkAudio()">check</button> -->
	<div id="summary" style="margin: 10px auto 10px; text-align: center; background-color: #002060; color: white; padding: 6px 12px; border: 0.5px solid; border-radius: 10px; width: fit-content; display:none"></div>
	<div id="update" style="text-align: center;">
	</div> 
	<form action="javascript:start()">
		<div id="start" style="text-align: center; margin: auto;">
			<div id="settings" style="border:1px solid; width: 70%; border-radius: 10px; padding-top: 1px;  padding-bottom: 20px; /*margin:20px;*/ margin: auto; margin-top: 20px;">
				<h2>Settings</h2>	
					<hr style="width: 20%">
				<br>
				<div>
					Refresh Every  <input id="inputTimer" type="range" value="10"   min='10' max="600" oninput="displayInputTimer()"> <lable id='displayInputTimer'>10</lable> seconds
				</div>
				<br>
				<hr style="width: 40%">
				<br>
				<div>
					Search via Pincode or District
					<div style="text-align: center; margin: auto; display:flex; flex-wrap: wrap; justify-content:center; margin:20px">
						<input class="tgl tgl-flip" id="cb5" type="checkbox"/ onclick="togglePinDistrict()">
		    			<label class="tgl-btn" data-tg-off="District" data-tg-on="Pincode" for="cb5"></label>
		    		</div>
					<div id="pincodeDiv" style="display: none">
						Enter pincode : <input type="number" value="452001" id="inputPincode" maxlength="6" minlength="6">
					</div>
					<div id="districtDiv">
						Select State <select name="inputState" id="inputState" onchange="fetchDistrict(this.value)"></select>&nbsp;&nbsp;
						Select District <select id="inputDistrict"></select>
					</div>
				</div>
				<br>
				<hr style="width: 40%">

				<!-- <br> -->
					<div style="text-align: center; margin: auto; display:flex; flex-wrap: wrap; justify-content:center; margin: 20px;">
						<input class="tgl tgl-flip" id="dose" type="checkbox"/>
		    			<label class="tgl-btn" data-tg-off="Dose-1" data-tg-on="Dose-2" for="dose"></label>
		    		</div>
				<!-- <br> -->
				<hr style="width: 40%">


				<br>
				<div>
					<!-- Highlight Available centers having -->
					Create Audio and Visual Alerts for
					<div style="display: flex; flex-wrap: wrap; justify-content: center; padding: 5px;">
						<div class="ck-button" style="margin:5px;">
						   <label>
						      <input type="checkbox" id="check18" value="1"><span>18+</span>
						   </label>
						</div>
						<div class="ck-button" style="margin:5px;">
						   <label>
						      <input type="checkbox" id="check45" value="1"><span>45+</span>
						   </label>
						</div>
						<div class="ck-button" style="margin:5px;">
						   <label>
						      <input type="checkbox" id="checkCovishield" value="1"><span>COVISHIELD</span>
						   </label>
						</div>
						<div class="ck-button" style="margin:5px;">
						   <label>
						      <input type="checkbox"id="checkCovaxin" value="1"><span>COVAXIN</span>
						   </label>
						</div>
						<div class="ck-button" style="margin:5px;">
						   <label>
						      <input type="checkbox"id="checkFree" value="1"><span>Free</span>
						   </label>
						</div>	
						<div class="ck-button" style="margin:5px;">
						   <label>
						      <input type="checkbox"id="checkPaid" value="1"><span>Paid</span>
						   </label>
						</div>													
					</div>
				</div>				


			</div>
			<div style="margin: auto; margin-top: 20px; text-align: center;">
				<button type="submit" id="startBtn" class="startBtn" disabled>START</button>
			</div>
		</div>
	</form>

	<div id="data"></div>
	
	<div id="showPast" style="display: none; text-align: center; margin-top: 20px;" >
		<button  id="pastButton" onclick="showPast()">Show History</button>
		<div id="past" style="text-align: center; min-width: 100%; display: none">
			<hr style="width: 70%">
			<u><b><h3>History</h3></b></u>
			<div id="pastData" style="text-align: center;  display:flex; flex-wrap: wrap; justify-content:center;"></div>
		</div>
	</div>
<script type="text/javascript">
	function displayInputTimer(){
		document.getElementById('displayInputTimer').innerHTML = document.getElementById('inputTimer').value
	}

	function togglePinDistrict(){
		var districtDiv = document.getElementById('districtDiv') 
		var pincodeDiv = document.getElementById('pincodeDiv')
		var currVal = document.getElementById('cb5').checked
		if (currVal){
			pincodeDiv.style.display = 'block'
			districtDiv.style.display = 'none'
		}
		else{
			pincodeDiv.style.display = 'none'
			districtDiv.style.display = 'block'
		}
	}
	fetchStates()
	function fetchStates(){
		fetch("https://cdn-api.co-vin.in/api/v2/admin/location/states")
		.then((response) => response.json())
		.then((data)=>{
			// console.log(data)
			var stateSelect = document.getElementById('inputState')
			var states = data['states']
			for(var i=0; i<states.length; i++){
				var state = document.createElement('option')
				state.innerHTML = states[i]['state_name']
				state.value = states[i]['state_id']
				if(states[i]['state_name']=='Madhya Pradesh'){
					state.setAttribute('selected', 'true')
				}
				stateSelect.appendChild(state)
			}
			fetchDistrict(20)
		})
		.catch(err=>{
			document.getElementById('errorDisplay').innerHTML = 'Error, Please Refresh after a few seconds<br>' + err
		})
	}
	
	function fetchDistrict(State_id){
		var selectDistrict = document.getElementById('inputDistrict')
		selectDistrict.innerHTML = ''
		// console.log("city data : " + data.value)
		fetch("https://cdn-api.co-vin.in/api/v2/admin/location/districts/" + State_id)
		.then((response) => response.json())
		.then((data)=>{
			// console.log(data)
			
			var districts = data['districts']
			for(var i=0; i<districts.length; i++){
				var district = document.createElement('option')
				district.innerHTML = districts[i]['district_name']
				district.value = districts[i]['district_id']
				if(districts[i]['district_name']=="Indore"){
					district.setAttribute('selected', 'true')
				}
				selectDistrict.appendChild(district)
			}
			document.getElementById('startBtn').disabled = false
		})
		.catch(err=>{
			document.getElementById('errorDisplay').innerHTML = 'Error, Please Refresh after a few seconds<br>' + err
		})
	}
</script>
<script type="text/javascript">
	var url
	var refreshTime
	var pastDataArrayDay0 = {}
	var currDataArrayDay0 = {}
	var pastDataArrayDay1 = {}
	var currDataArrayDay1 = {}
	var pastDataArrayDay2 = {}
	var currDataArrayDay2 = {}
	var query
	var dosage
	function start(){
		document.getElementById('start').style.display = 'none'
		var summary = document.getElementById('summary')
		summary.style.display = 'block'
		document.getElementById('showPast').style.display = 'block'
		refreshTime = document.getElementById('inputTimer').value
		if(document.getElementById('cb5').checked){
			url = "https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByPin?pincode="+ document.getElementById('inputPincode').value
			summary.innerHTML = document.getElementById('inputPincode').value
		}
		else{
			url = "https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id="+ document.getElementById('inputDistrict').value
			summary.innerHTML = document.getElementById('inputDistrict').item(document.getElementById('inputDistrict').selectedIndex).innerHTML
		}
		if(document.getElementById('dose').checked){
			dosage = 'available_capacity_dose2'
			summary.innerHTML += " - Dose-2"
		}
		else{
			dosage = 'available_capacity_dose1'
			summary.innerHTML += " - Dose-1"
		}
		query = ' if('
		var queryAdded = false
		var ageAdded = false
		var vaccineAdded = false
		var priceAdded = false
		if (document.getElementById('check18').checked){
			query += '((age==18)'
			queryAdded = true
			ageAdded = true
		}
		if (document.getElementById('check45').checked){
			query += (queryAdded) ? ' || (age==45))' : '(age==45)' 
			queryAdded = true
		}
		else{
			query += (ageAdded)? ')':''
		}
		if (document.getElementById('checkCovishield').checked){
			query += (queryAdded)? ' && ((vaccine=="COVISHIELD")' : '((vaccine=="COVISHIELD")'
			queryAdded = true
			vaccineAdded = true
		}
		if (document.getElementById('checkCovaxin').checked){
			query += (vaccineAdded)? ' || (vaccine=="COVAXIN"))' : (queryAdded)? ' && (vaccine=="COVAXIN")' : '(vaccine=="COVAXIN")'
			queryAdded = true
		}
		else{
			query += (vaccineAdded)? ')': ''
		}
		if (document.getElementById('checkFree').checked){
			query += (queryAdded)? ' && ((fee_type == "Free")' : '((fee_type == "Free")'
			queryAdded = true
			priceAdded = true
		}
		if (document.getElementById('checkPaid').checked){
			query += (priceAdded)? ' || (fee_type == "Paid"))' : (queryAdded)? ' && (fee_type == "Paid")' : '(fee_type=="Paid")'
			queryAdded = true
		}
		else{
			query += (priceAdded)? ')' : ''
		}
		query += ')'
		if (!queryAdded){
			query = false
		}


		// console.log(query)

		getData()
	}
	function playAudio(){
		document.getElementById('audioAlert').play()
	}
	// getData()
	var flashAlert = false
	var flashRequested = false

    // function countdown() {
    //   if (timeLeft == 0) {
    //     clearTimeout(timerId);
        
    //   } else {
    //     document.getElementById('timeRemaining').innerHTML = timeLeft;
    //     timeLeft--;
    //   }
    // }

	async function getData(){
		// console.log("fetching for  : " + url)
		if(i==0){ currDataArrayDay0 = {}		}
		if(i==1){ currDataArrayDay1 = {}		}
		if(i==2){ currDataArrayDay2 = {}		}
		  const myNode = document.getElementById("data");
		  while (myNode.firstChild) {
		    myNode.removeChild(myNode.lastChild);
		  }
		flashAlert = false
		flashRequested = false
		document.getElementById('audioAlert').pause();
		// document.getElementById('update').style.backgroundColor = 'white'

		// var pincode = 452001
		// var district_id = 314   //622 agra, 314 indore

		document.getElementById('update').innerHTML ="<b> LAST UPDATED AT : <span style='color:#002060'>"+ new Date  + "</span><br><b>Refreshing in " + '<lable id="timeRemaining">'+refreshTime+'</lable>' + " seconds</b>"

		var timeLeft = refreshTime-1
	    var timerId = setInterval(countdown, 1000);
	    function countdown() {
	      if (timeLeft == 0) {
	        clearTimeout(timerId);
	        
	      } else {
	        document.getElementById('timeRemaining').innerHTML = timeLeft;
	        timeLeft--;
	      }
	    }


		for(var i=0; i<3; i++){
			let dateObj = new Date(new Date().getTime()+(i*24*60*60*1000));
			let month = dateObj.getMonth()+1
			let date = dateObj.getDate() + "-"+ month + "-" +  dateObj.getFullYear();
			// dates.push(date)

			let div = document.createElement("div")
			div.setAttribute("id", "data"+i)
			div.style = 'padding:10px; display:flex; flex-wrap: wrap; justify-content:center;'
			// div.innerHTML = '<br> Date : ' + date + ' <br>'
			// var title = document.createElement('p')
			document.getElementById('data').appendChild(div)	

			// FOR PINCODE
			// await fetch("https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByPin?pincode="+pincode+"&date=" + date)

			// FOR DISTRICT
			// await fetch("https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id="+district_id+"&date=" + date)
			await fetch(url+"&date=" + date)
			.then((response) => response.json())
			.then((data)=>{
				console.log("Fetch Successful at "+(new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds())
				document.getElementById('data'+i).innerHTML = '<div style="width:100%;"><center><u><br><b><h3>' + date + ' </b>    ( Total Centers: ' + JSON.stringify(data['sessions'].length) + ')</h3></center></div><br>' 
				// flashAlert = false
				// if(i==1){
				// 	console.log(data['sessions'])
				// }
					if(data['sessions'].length!=0){
							var count = 0
							for(var idata in data['sessions']){
								if(i==0){ currDataArrayDay0[data['sessions'][idata]['center_id']] = data['sessions'][idata][dosage]	}
								if(i==1){ currDataArrayDay1[data['sessions'][idata]['center_id']] = data['sessions'][idata][dosage]	}
								if(i==2){ currDataArrayDay2[data['sessions'][idata]['center_id']] = data['sessions'][idata][dosage]	}
								if(data['sessions'][idata][dosage]>0){

									count++;
									let div = document.createElement('div')
									document.getElementById('data'+i).appendChild(div)
									div.style = 'margin:5px; padding:5px; border:2px solid; border-radius:10px; width:30%;'

									var age = data['sessions'][idata]['min_age_limit']
									var name = data['sessions'][idata]['name']
									var vaccine = data['sessions'][idata]['vaccine']
									var fee_type = data['sessions'][idata]['fee_type']

									// if (age==45 || vaccine=='COVAXIN'){
									// 	flashRequested = true
									// 	div.style.color= 'red'
									// 	if (age==45 && vaccine=='COVAXIN'){
									// 		div.style.color = 'green'
									// 		div.style.backgroundColor = '#B3EA8E'
									// 		alertUser()
									// 		console.log("user alert due to " + vaccine + age)
									// 	}
									// }
									// var run
									if (query!=false){
										var tempQuery = query
										tempQuery +=`{	
													flashRequested = true;
													div.style.color = 'green';
													div.style.backgroundColor = '#B3EA8E';
													// console.log("Successful for : " + age +":" + vaccine +" : " + name)
													alertUser();
												}
												else{
													div.style.color = 'black'
													div.style.backgroundColor = 'white'
												}`
										console.log(tempQuery)
										eval(tempQuery)
										// run = new Function(query)
										// return(run())
										// console.log("Q : " + query)
									}
									// else{
									// 	div.style.color = 'black'
									// 	div.style.backgroundColor = 'white'
									// }
									

									// div.innerHTML += "<b>Age : " + age
									// div.innerHTML += "<b><br>Vaccine : " + vaccine
									div.innerHTML += '<b><div class="row" style="display:flex; flex-wrap: wrap; justify-content:center; "><div class="col-6" style="text-align: center; width:24% ; border:1px solid; border-radius:5px"> Price : '+data['sessions'][idata]['fee']+'</div><div class="col-6" style="text-align: center; width:20%">'+age+'+</div><div class="col-6" style="text-align: center; width:30%">'+vaccine+'</div><div class="col-6" style="margin-left:2px; text-align: center; width:24%; color:red; border:1px solid; border-radius:5px"> Avl : '+data['sessions'][idata][dosage]+'</div></div><hr>'
									div.innerHTML += "Name : " + name
									div.innerHTML += "<br>Address : " + data['sessions'][idata]['address'] + ', PIN:' + data['sessions'][idata]['pincode']
									// div.innerHTML += "<b><br>Total 1st Dose Available: " + data['sessions'][idata]['available_capacity_dose1'] +'<b>'

									addPastData(data['sessions'][idata], i)
									

									// console.log(data['sessions'][idata])
								}

							}
				}
				else{
					document.getElementById('data'+i).innerHTML += "<center><br>No Slot available</center>"
				}
				if(count==0){
					document.getElementById('data'+i).innerHTML += "<center><br>No Slot available</center>"
				}
				if (i==2){
					console.log("----------------------------")
					setTimeout(function () {
						getData()
				    }, refreshTime*1000);
					
				}
				// pastDataArrayDay0 = currDataArrayDay0
				Object.assign(pastDataArrayDay0, currDataArrayDay0);
				currDataArrayDay0 = {}
				Object.assign(pastDataArrayDay1, currDataArrayDay1);
				currDataArrayDay1 = {}
				Object.assign(pastDataArrayDay2, currDataArrayDay2);
				currDataArrayDay2 = {}
			})
		.catch(err=>{

			document.getElementById('data'+i).innerHTML = '<center style="color:red">Fetch Limit Reached.. Please wait, trying in 60 sec<br>'+ err+'</center>'
			i = 4
			console.log("----------------------------")
			var timeLeft = 59
		    var timerId = setInterval(countdown, 1000);
		    function countdown() {
		      if (timeLeft == 0) {
		        clearTimeout(timerId);
		        
		      } else {
		        document.getElementById('timeRemaining').innerHTML = timeLeft;
		        timeLeft--;
		      }
		    }

			setTimeout(function () {
				getData()
		    }, 60000);

		})


		}
	}

	function alertUser(){
		// console.log("trying audio")	
		if(flashRequested && !audioPlaying()){
			document.getElementById('audioAlert').play()
			
		}			
		if (flashRequested==true && flashAlert == false){
			// for(var i=0; i<5;i++){
			// 	document.body.style.backgroundColor = "#ff0";
			// 	document.body.style.backgroundColor = "#f00";
			// }
			// document.body.style.backgroundColor = "white";

			flashAlert = true
			var flashCount = 0
			var f = 0;
			flash()
			// var task = setInterval(flash, 200);
			function flash() {
				if (flashAlert && flashRequested) {
				    // document.getElementById('update').style.backgroundColor=(f = ~f) ? '#ff0' : '#f00';
				    document.body.style.backgroundColor=(f = ~f) ? '' : 'red';
				    if(flashCount<20){
				    	setTimeout(flash, 200);
				    	flashCount += 1;}
				}
			}
		}
	}

	function audioPlaying(){
			var myAudio = document.getElementById('audioAlert');

			if (myAudio.duration > 0 && !myAudio.paused) {
				return true

			} else {
				return false
			}
	}



	function addPastData(data, day){
		if(day==0){
			if (currDataArrayDay0[data['center_id']] != 0 && pastDataArrayDay0[data['center_id']] != currDataArrayDay0[data['center_id']]){
					// console.log("")
					// console.log("for "+data['center_id'] + " : " + )
					// console.log("for " + data['center_id']+ " : " +  currDataArrayDay0[data['center_id']] +":"+ pastDataArrayDay0[data['center_id']])
					var month = (new Date).getMonth() + 1
					var date = (new Date).getDate() + day
					var allPastData = document.getElementById('pastData')
					var newData = document.createElement('div')
					newData.style = 'margin:5px; padding:5px; border:0.4px solid; border-radius:10px; width:60%; text-align: center; justify-content:center;'
					newData.innerHTML = '<b>['+ date  + '-' + month + '] &nbsp;' + data[dosage] + ' ' + data['vaccine'] + ' </b> dose for age  <b>' + data['min_age_limit']+ '+ </b> were available at <b>' + data['name'] + '</b> at  <b>' + (new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds() +' </b> '
					allPastData.insertBefore(newData, allPastData.firstChild)
				}
		}
		else if(day==1){
			if (currDataArrayDay1[data['center_id']] != 0 && pastDataArrayDay1[data['center_id']] != currDataArrayDay1[data['center_id']]){
					// console.log("")
					// console.log("for "+data['center_id'] + " : " + )
					// console.log("for " + data['center_id']+ " : " +  currDataArrayDay1[data['center_id']] +":"+ pastDataArrayDay1[data['center_id']])
					var month = (new Date).getMonth() + 1
					var date = (new Date).getDate() + day
					var allPastData = document.getElementById('pastData')
					var newData = document.createElement('div')
					newData.style = 'margin:5px; padding:5px; border:0.4px solid; border-radius:10px; width:60%; text-align: center; justify-content:center;'
					newData.innerHTML = '<b>['+ date  + '-' + month + '] &nbsp;' + data[dosage] + ' ' + data['vaccine'] + ' </b> dose for age  <b>' + data['min_age_limit']+ '+ </b> were available at <b>' + data['name'] + '</b> at  <b>' + (new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds() +' </b> '
					allPastData.insertBefore(newData, allPastData.firstChild)
				}
		}
		else if(day==2){
			if (currDataArrayDay2[data['center_id']] != 0 && pastDataArrayDay2[data['center_id']] != currDataArrayDay2[data['center_id']]){
					// console.log("")
					// console.log("for "+data['center_id'] + " : " + )
					// console.log("for " + data['center_id']+ " : " +  currDataArrayDay2[data['center_id']] +":"+ pastDataArrayDay2[data['center_id']])
					var month = (new Date).getMonth() + 1
					var date = (new Date).getDate() + day
					var allPastData = document.getElementById('pastData')
					var newData = document.createElement('div')
					newData.style = 'margin:5px; padding:5px; border:0.4px solid; border-radius:10px; width:60%; text-align: center; justify-content:center;'
					newData.innerHTML = '<b>['+ date  + '-' + month + '] &nbsp;' + data[dosage] + ' ' + data['vaccine'] + ' </b> dose for age  <b>' + data['min_age_limit']+ '+ </b> were available at <b>' + data['name'] + '</b> at  <b>' + (new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds() +' </b> '
					allPastData.insertBefore(newData, allPastData.firstChild)
				}			
		}
	}

	function showPast(){
		  var x = document.getElementById("past");
		  if (x.style.display === "none") {
		    x.style.display = "block";
		    document.getElementById('pastButton').innerHTML = 'Hide History'
		  } else {
		    x.style.display = "none";
		    document.getElementById('pastButton').innerHTML = 'Show History'
		  }
	}
</script>
</body>
</html>



<!-- {"sessions":[{"center_id":646384,"name":"NAGAR NIGAM ZONE 06","address":"SUBHASH NAGAR Pardesipura Indore","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":22,"long":75,"fee_type":"Free","session_id":"ee7983a1-a2a2-42ef-8253-2a216527fe62","date":"21-05-2021","available_capacity_dose1":200,"available_capacity_dose2":0,"available_capacity":200,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]}]} -->



<!-- {"sessions":[{"center_id":646385,"name":"NAGAR NIGAM ZONE 09","address":"PANCHAM KI FEL","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":0,"long":0,"fee_type":"Free","session_id":"3fa12d47-6ce2-4a23-ad17-eaf2421e74ca","date":"21-05-2021","available_capacity_dose1":139,"available_capacity_dose2":0,"available_capacity":139,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]},{"center_id":670281,"name":"Mai Mangeshkar Sabhagrah","address":"Loha Mandi Sneh Nagar","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":0,"long":0,"fee_type":"Free","session_id":"1885007e-a3ec-425f-84f7-3ec8b1840a08","date":"21-05-2021","available_capacity_dose1":1,"available_capacity_dose2":0,"available_capacity":1,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]},{"center_id":703945,"name":"Saflata School","address":"Sant Marg Gandhinagar","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":22,"long":75,"fee_type":"Free","session_id":"b6e81b56-5020-43b8-a61f-9935916269bc","date":"21-05-2021","available_capacity_dose1":66,"available_capacity_dose2":0,"available_capacity":66,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]},{"center_id":703948,"name":"Mount Litreza School Khudel","address":"Mount Litreza School Khudel","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":22,"long":76,"fee_type":"Free","session_id":"4ee8cff0-5262-4521-a8a4-3197b98c9672","date":"21-05-2021","available_capacity_dose1":92,"available_capacity_dose2":0,"available_capacity":92,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]}]} -->




<!-- {"sessions":[{"center_id":666530,"name":"GOVT. SCHOOL AMAR TEKARI","address":"VIKASH NAGAR AMAR TEKADI","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":22,"long":75,"fee_type":"Free","session_id":"6fd3b3fa-c12d-47ec-9acc-ad2f071fac3a","date":"21-05-2021","available_capacity_dose1":1,"available_capacity_dose2":0,"available_capacity":1,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]},{"center_id":673744,"name":"Abhay Prashal Center","address":"Jain Social Group Legend Abhay Prashal Sports Club Race Course Rd Race Course Road Indore","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":22,"long":75,"fee_type":"Free","session_id":"869f15fc-8122-403e-99a7-3be36ef4bc85","date":"21-05-2021","available_capacity_dose1":1,"available_capacity_dose2":0,"available_capacity":1,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]},{"center_id":646385,"name":"NAGAR NIGAM ZONE 09","address":"PANCHAM KI FEL","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":0,"long":0,"fee_type":"Free","session_id":"3fa12d47-6ce2-4a23-ad17-eaf2421e74ca","date":"21-05-2021","available_capacity_dose1":1,"available_capacity_dose2":0,"available_capacity":1,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]},{"center_id":561406,"name":"MGM MC","address":"MGM MEDICAL COLLEGE AB ROAD CRP LINE INDORE","state_name":"Madhya Pradesh","district_name":"Indore","block_name":"INDORE","pincode":452001,"from":"09:00:00","to":"17:00:00","lat":22,"long":75,"fee_type":"Free","session_id":"51a9f73a-019f-4c22-99d8-bb8e944d2a4e","date":"21-05-2021","available_capacity_dose1":188,"available_capacity_dose2":0,"available_capacity":188,"fee":"0","min_age_limit":18,"vaccine":"COVISHIELD","slots":["09:00AM-11:00AM","11:00AM-01:00PM","01:00PM-03:00PM","03:00PM-05:00PM"]}]} -->